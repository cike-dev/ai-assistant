test_cases:
  # ====== Case 1 ====== #
  - test_case: uni_academic_support_happy_path_done
    steps:
      - user: "What are the exam retake rules for this semester?"
        assertions:
          - flow_started:
              operator: "any"
              flow_ids:
                - "uni_academic_support"
          - slot_was_set:
              - name: "user_question"
          - action_executed: "action_trigger_search"
          - generative_response_is_relevant:
              threshold: 0.6
          - generative_response_is_grounded:
              threshold: 0.6

      - user: "done"
        assertions:
          - slot_was_set:
              - name: "followup_choice"
                value: "done"
          - flow_completed:
              flow_id: "uni_academic_support"              


  # ====== Case 2 ====== #
  - test_case: uni_academic_support_handoff_path
    steps:
      - user: "Who can I contact about financial aid appeals?"
        assertions:
          - flow_started: "uni_academic_support"
          - slot_was_set:
              - name: "user_question"
          - action_executed: "action_trigger_search"
              # name: "action_trigger_search"
          - generative_response_is_relevant:
              threshold: 0.6
          - generative_response_is_grounded:
              threshold: 0.6

      - user: "handoff"
        assertions:
          - slot_was_set:
              - name: "followup_choice"
                value: "handoff"
          # second search for contact info
          - action_executed: "action_trigger_search"
              # name: "action_trigger_search"
          # your wrap-up utterance after suggest_contacts
          - bot_uttered:
              utter_name: "utter_wrap_up_handoff"
          - flow_completed:
              flow_id: "uni_academic_support"

  # ====== Case 3 ====== #
  - test_case: uni_academic_support_followup_new_question
    steps:
      - user: "How do I register for summer courses?"
        assertions:
          - flow_started: "uni_academic_support"
          - slot_was_set:
              - name: "user_question"
          - action_executed: "action_trigger_search"
              # name: "action_trigger_search"
          - generative_response_is_relevant:
              threshold: 0.6

      - user: "new_question"
        assertions:
          - slot_was_set:
              - name: "followup_choice"
                value: "new_question"
          # We should be back at the collect_user_question step
          - bot_uttered:
              utter_name: "utter_ask_user_question"

      - user: "What is the deadline to drop a course?"
        assertions:
          - slot_was_set:
              - name: "user_question"
          - action_executed: "action_trigger_search"
              # name: "action_trigger_search"
          - generative_response_is_relevant:
              threshold: 0.6
          - flow_completed:
              flow_id: "uni_academic_support"              

  # ====== Case 4 ====== #
  - test_case: specialized_search_flow_online_lookup
    steps:
      - user: "I can't find the updated grading scale for the new AI track."
        assertions:
          - flow_started: "specialized_search_flow"
          # The sub-agent should now run and respond
          - bot_uttered:
              text_matches: "Here is the updated grading scale"
          - generative_response_is_relevant:
              threshold: 0.6
          - generative_response_is_grounded:
              threshold: 0.6
          - flow_completed:
              flow_id: "specialized_search_flow"