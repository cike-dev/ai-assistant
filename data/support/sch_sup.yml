flows:
  uni_academic_support:
    description: >
      Helps students with academic questions, provides follow-ups, supports topic changes,
      and offers escalation to a human if needed.

    steps:
      - action: utter_academic_selected

      - id: collect_user_question
        collect: user_question
        description: The student's academic question
        utter: utter_ask_user_question
        next: trigger_search

      - id: trigger_search
        action: action_trigger_search
        next: check_success

      - id: check_success
        action: action_check_rag_success
        next:
          - if: slots.rag_result_found
            then: offer_more_options
          - else: no_result_found

      - id: no_result_found
        action: utter_no_help_found
        next: offer_more_options

      - id: offer_more_options
        collect: followup_choice
        description: The user's next intent or question
        utter: utter_ask_followup_choice
        next:
          - if: slots.followup_choice == "new_question"
            then: collect_user_question

          - if: slots.followup_choice == "handoff"
            then: escalate_to_human

          - if: slots.followup_choice == "end"
            then: END
            
          - else: END

      - id: escalate_to_human
        call: human_handoff